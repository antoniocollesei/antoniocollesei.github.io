<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    <!-- Metadata, OpenGraph and Schema.org -->
    
    <!-- Website verification -->
    <meta name="google-site-verification" content="">
<!-- Avoid warning on Google Chrome
        Error with Permissions-Policy header: Origin trial controlled feature not enabled: 'interest-cohort'.
        see https://stackoverflow.com/a/75119417
    -->
    <meta http-equiv="Permissions-Policy" content="interest-cohort=()">

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>DNA Alteration &amp; Pharmacological Response | Antonio  Collesei</title>
    <meta name="author" content="Antonio  Collesei">
    <meta name="description" content="A simple R project to predict pharmacological response from mutational data in cancer cell lines">
    <meta name="keywords" content="bioinformatics, data-science, phd, portfolio-website">


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light">

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%85%B0&lt;/text&gt;&lt;/svg&gt;">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://antoniocollesei.github.io/projects/1_project/">
    
    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark">

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    

  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Antonio </span>Collesei</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">about</a>
              </li>
              
              <!-- Blog 
              <li class="nav-item ">
                <a class="nav-link" href="/blog/">blog</a>
              </li> -->

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/publications/">publications</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">projects</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/repositories/">repositories</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/cv/">cv</a>
              </li>

              <!-- Toogle theme mode -->
              <li class="toggle-container">
                <button id="light-toggle" title="Change theme">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </button>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <!-- Scrolling Progress Bar -->
      <progress id="progress" value="0">
        <div class="progress-container">
          <span class="progress-bar"></span>
        </div>
      </progress>
    </header>


    <!-- Content -->
    <div class="container mt-5">
      <!-- page.html -->
        <div class="post">

          <header class="post-header">
            <h1 class="post-title">DNA Alteration &amp; Pharmacological Response</h1>
            <p class="post-description">A simple R project to predict pharmacological response from mutational data in cancer cell lines</p>
          </header>

          <article>
            <h1 id="data-upload-and-inspection">Data Upload and Inspection</h1>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">load</span><span class="p">(</span><span class="s2">"project_dataset.RData"</span><span class="p">)</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">CCLE_MUT_CNA_AMP_DEL_binary_Revealer</span><span class="p">[,</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##                  DMS53_LUNG SW1116_LARGE_INTESTINE NCIH1694_LUNG P3HR1_HAEMATOPOIETIC_AND_LYMPHOID_TISSUE
## AKT3_MUT                  0                      0             0                                        0
## ABI1_MUT                  0                      0             0                                        0
## CDH2_MUT                  0                      0             0                                        0
## LOC100130776_MUT          0                      0             0                                        0
## HDAC6_MUT                 0                      0             0                                        0
## BCL2L11_MUT               0                      0             0                                        0
</code></pre></div></div>

<p>The <strong>CCLE_MUT_CNA_AMP_DEL_binary_Revealer</strong> file contains mutations for each cell line, from the CCLE project. Each line corresponds to a mutation (of various types) in a gene; for example HDAC6_MUT indicates a single base mutation (MUT) in the HDAC6 gene.
Each column from the third corresponds to a cell line. An entry to 1 indicates that the mutation in that gene is present in the cell line, while 0 indicates that the mutation is not present in the cell line. More info about the project can be found here: <a href="https://portals.broadinstitute.org/ccle/about" rel="external nofollow noopener" target="_blank">https://portals.broadinstitute.org/ccle/about</a>.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">target</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">target_data_NAcount_August21</span><span class="w">
</span><span class="n">row.names</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="n">target</span><span class="p">[,</span><span class="m">1</span><span class="p">])</span><span class="w">
</span><span class="n">target</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">target</span><span class="p">[,</span><span class="m">-1</span><span class="p">]</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">target</span><span class="p">[,</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##                   X22RV1_PROSTATE X2313287_STOMACH X42MGBA_CENTRAL_NERVOUS_SYSTEM X451LU_SKIN
## (5Z)-7-Oxozeaenol       0.8625642        0.7597489                      0.6585792   0.1044209
## 5-Fluorouracil          0.4865437        0.6063343                      0.7244520   0.9585177
## 681640                  0.9579365        0.9682534                      0.9476494         NaN
## A-443654                      NaN              NaN                            NaN         NaN
## A-770041                      NaN              NaN                            NaN         NaN
## Afatinib (1)            0.9808510        0.9815897                      0.9844018   0.9888358
</code></pre></div></div>

<p>The <strong>target_data_NAcount_August21</strong> file contains the response of cell lines to various pharmacological compounds, from the GDSC project. Each row corresponds to a compound; each column corresponds to a cell line. The value of an entry is a measure of how much the cell line responds to the drug compound. More info about the project can be found here: <a href="https://www.cancerrxgene.org/" rel="external nofollow noopener" target="_blank">https://www.cancerrxgene.org/</a></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">readr</span><span class="p">)</span><span class="w">
</span><span class="n">pathways</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_delim</span><span class="p">(</span><span class="s2">"PathwayCommons12.panther.hgnc.txt"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"\t"</span><span class="p">,</span><span class="w"> </span><span class="n">escape_double</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w">
    </span><span class="n">col_types</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cols</span><span class="p">(</span><span class="n">INTERACTION_DATA_SOURCE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col_skip</span><span class="p">(),</span><span class="w">
    </span><span class="n">INTERACTION_PUBMED_ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col_skip</span><span class="p">(),</span><span class="w">
    </span><span class="n">INTERACTION_TYPE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col_skip</span><span class="p">(),</span><span class="w"> </span><span class="n">MEDIATOR_IDS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col_skip</span><span class="p">(),</span><span class="w">
    </span><span class="n">PATHWAY_NAMES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col_skip</span><span class="p">()),</span><span class="w"> </span><span class="n">trim_ws</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">pathways</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## # A tibble: 6 × 2
##   PARTICIPANT_A PARTICIPANT_B
##`&lt;chr&gt;`         `&lt;chr&gt;`
## 1 ABAT          ALDH5A1
## 2 ABAT          ALDH6A1
## 3 ABAT          CSAD
## 4 ABAT          GAD1
## 5 ABAT          GAD2
## 6 ACHE          CHEBI:15354
</code></pre></div></div>

<p>The <strong>PathwayCommons12.panther.hgnc</strong> file contains all the gene-gene interactions discovered so far; this is useful in order to smooth the mutations matrix, which is extremely sparse. It has been downloaded from <a href="https://www.pathwaycommons.org/" rel="external nofollow noopener" target="_blank">https://www.pathwaycommons.org/</a>.</p>

<h2 id="needed-packages">Needed Packages</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">NMF</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">SummarizedExperiment</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">netSmooth</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">stringi</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">stringr</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">readr</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">igraph</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">caret</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">neuralnet</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">plotly</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h1 id="mutations-matrix-smoothing">Mutations Matrix Smoothing</h1>

<p>The CCLE dataset sonsiders 48270 mutations: since the human genetic pool consists of around 20000 genes, and each one can mutate in three different ways (insertion, deletion, single-base mutation, the dataset is involving almost every possible mutation (20k*3 = 60k). It is
necessary to select the most relevant mutations, because they exceed enourmously the number of cell lines, having a strong impact on future computations. The Non-Negative Matrix Factorization (NMF) is a powerful tool to perform feature selection, but it works well with non-sparse matrices.</p>

<p>The CCLE dataset appears to be extremely sparse, as it is possible to appreciate from the following heatmap. Even though the size has been reduced for computational reasons, the same situation can be extended to the whole set.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">heatmap</span><span class="p">(</span><span class="n">as.matrix</span><span class="p">(</span><span class="n">CCLE_MUT_CNA_AMP_DEL_binary_Revealer</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">200</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">200</span><span class="p">]))</span><span class="w">
</span></code></pre></div></div>

<p>It may be useful to rename the matrices to make them more “user-friendly” to handle.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mutations</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">CCLE_MUT_CNA_AMP_DEL_binary_Revealer</span><span class="w">
</span><span class="n">drugs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">target_data_NAcount_August21</span><span class="w">
</span></code></pre></div></div>

<p>It is important to work with comparable datasets, containing the same cell lines: this will enable robust results in terms of model construction. In the following lines of code, only common cell lines will be kept, filtering out the uncommon.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tissues_CCLE</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">mutations</span><span class="p">)</span><span class="w">
</span><span class="n">tissues_CCLE</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">unique</span><span class="p">(</span><span class="n">gsub</span><span class="p">(</span><span class="s2">"[^_]*_(.*)"</span><span class="p">,</span><span class="w"> </span><span class="s2">"\\1"</span><span class="p">,</span><span class="w"> </span><span class="n">tissues_CCLE</span><span class="p">))</span><span class="w">

</span><span class="n">tissues_GDSC</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">drugs</span><span class="p">)[</span><span class="m">-1</span><span class="p">]</span><span class="w">
</span><span class="n">tissues_GDSC</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">unique</span><span class="p">(</span><span class="n">gsub</span><span class="p">(</span><span class="s2">"[^_]*_(.*)"</span><span class="p">,</span><span class="w"> </span><span class="s2">"\\1"</span><span class="p">,</span><span class="w"> </span><span class="n">tissues_GDSC</span><span class="p">))</span><span class="w">

</span><span class="c1"># Which and how many different tissues are being considered?</span><span class="w">
</span><span class="p">(</span><span class="n">tissues</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sort</span><span class="p">(</span><span class="n">intersect</span><span class="p">(</span><span class="n">tissues_CCLE</span><span class="p">,</span><span class="w"> </span><span class="n">tissues_GDSC</span><span class="p">)))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##  [1] "AUTONOMIC_GANGLIA"                  "BILIARY_TRACT"                      "BONE"                               "BREAST"
##  [5] "CENTRAL_NERVOUS_SYSTEM"             "ENDOMETRIUM"                        "HAEMATOPOIETIC_AND_LYMPHOID_TISSUE" "KIDNEY"
##  [9] "LARGE_INTESTINE"                    "LIVER"                              "LUNG"                               "OESOPHAGUS"
## [13] "OVARY"                              "PANCREAS"                           "PLEURA"                             "PROSTATE"
## [17] "SKIN"                               "SMALL_INTESTINE"                    "SOFT_TISSUE"                        "STOMACH"
## [21] "THYROID"                            "UPPER_AERODIGESTIVE_TRACT"          "URINARY_TRACT"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">
</span><span class="n">k</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">tissues</span><span class="p">)</span><span class="w">

</span><span class="c1"># Keeping only common cell lines</span><span class="w">
</span><span class="n">mutations</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mutations</span><span class="p">[,</span><span class="w"> </span><span class="n">grep</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="n">tissues</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">collapse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"|"</span><span class="p">),</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">mutations</span><span class="p">))]</span><span class="w">
</span><span class="n">drugs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">drugs</span><span class="p">[,</span><span class="w"> </span><span class="n">grep</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="n">tissues</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">collapse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"|"</span><span class="p">),</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">drugs</span><span class="p">))]</span><span class="w">
</span></code></pre></div></div>

<p>It is helpful to perform smoothing independently for mutations,
insertions and deletions: the Pathway Commons interaction database
considers gene-gene relationships and the smoothing algorithm (package
<em>netSmooth</em>) recognizes the gene names in the dataset with respect to
the adjacency matrix built on the interaction database itself. The
following process is meant to separate the datasets into three smaller
datasets, apply smoothing and then rebuild the original dataset, that
now will include the non-sparse information.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Creation of the three datasets based on the type of mutation</span><span class="w">
</span><span class="n">mutations_MUT</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mutations</span><span class="p">[</span><span class="n">grep</span><span class="p">(</span><span class="s2">"_MUT"</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="p">(</span><span class="n">mutations</span><span class="p">)),</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="n">mutations_AMP</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mutations</span><span class="p">[</span><span class="n">grep</span><span class="p">(</span><span class="s2">"_AMP"</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="p">(</span><span class="n">mutations</span><span class="p">)),</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="n">mutations_DEL</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mutations</span><span class="p">[</span><span class="n">grep</span><span class="p">(</span><span class="s2">"_DEL"</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="p">(</span><span class="n">mutations</span><span class="p">)),</span><span class="w"> </span><span class="p">]</span><span class="w">

</span><span class="c1"># Remove the subscripts from the lines of the matrices to be analyzed</span><span class="w">
</span><span class="n">row.names</span><span class="p">(</span><span class="n">mutations_MUT</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">str_replace_all</span><span class="p">(</span><span class="n">row.names</span><span class="p">(</span><span class="n">mutations_MUT</span><span class="p">),</span><span class="w"> </span><span class="s2">"_MUT"</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">)</span><span class="w">
</span><span class="n">row.names</span><span class="p">(</span><span class="n">mutations_AMP</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">str_replace_all</span><span class="p">(</span><span class="n">row.names</span><span class="p">(</span><span class="n">mutations_AMP</span><span class="p">),</span><span class="w"> </span><span class="s2">"_AMP"</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">)</span><span class="w">
</span><span class="n">row.names</span><span class="p">(</span><span class="n">mutations_DEL</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">str_replace_all</span><span class="p">(</span><span class="n">row.names</span><span class="p">(</span><span class="n">mutations_DEL</span><span class="p">),</span><span class="w"> </span><span class="s2">"_DEL"</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">)</span><span class="w">

</span><span class="c1"># Creating the Adjacency Matrix</span><span class="w">
</span><span class="n">adj</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get.adjacency</span><span class="p">(</span><span class="n">graph.edgelist</span><span class="p">(</span><span class="n">as.matrix</span><span class="p">(</span><span class="n">pathways</span><span class="p">),</span><span class="w"> </span><span class="n">directed</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">))</span><span class="w">

</span><span class="c1"># Network smoothing</span><span class="w">
</span><span class="n">smoothed_MUT</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">netSmooth</span><span class="p">(</span><span class="n">as.matrix</span><span class="p">(</span><span class="n">mutations_MUT</span><span class="p">),</span><span class="w"> </span><span class="n">adj</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span><span class="w">

</span><span class="n">smoothed_AMP</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">netSmooth</span><span class="p">(</span><span class="n">as.matrix</span><span class="p">(</span><span class="n">mutations_AMP</span><span class="p">),</span><span class="w"> </span><span class="n">adj</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span><span class="w">

</span><span class="n">smoothed_DEL</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">netSmooth</span><span class="p">(</span><span class="n">as.matrix</span><span class="p">(</span><span class="n">mutations_DEL</span><span class="p">),</span><span class="w"> </span><span class="n">adj</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span><span class="w">
  
</span><span class="c1"># Rebuild</span><span class="w">
</span><span class="n">row.names</span><span class="p">(</span><span class="n">smoothed_MUT</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">paste0</span><span class="p">(</span><span class="n">row.names</span><span class="p">(</span><span class="n">smoothed_MUT</span><span class="p">),</span><span class="w"> </span><span class="s2">"_MUT"</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">)</span><span class="w">
</span><span class="n">row.names</span><span class="p">(</span><span class="n">smoothed_DEL</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">paste0</span><span class="p">(</span><span class="n">row.names</span><span class="p">(</span><span class="n">smoothed_DEL</span><span class="p">),</span><span class="w"> </span><span class="s2">"_DEL"</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">)</span><span class="w"> 
</span><span class="n">row.names</span><span class="p">(</span><span class="n">smoothed_AMP</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">paste0</span><span class="p">(</span><span class="n">row.names</span><span class="p">(</span><span class="n">smoothed_AMP</span><span class="p">),</span><span class="w"> </span><span class="s2">"_AMP"</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">)</span><span class="w">  
</span><span class="n">mutations.smoothed</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rbind</span><span class="p">(</span><span class="n">smoothed_MUT</span><span class="p">,</span><span class="w"> </span><span class="n">smoothed_AMP</span><span class="p">,</span><span class="w"> </span><span class="n">smoothed_DEL</span><span class="p">)</span><span class="w">

</span><span class="c1"># If a mutation is not present in any cell line, you can remove it</span><span class="w">
</span><span class="c1"># (it is also an NMF algorithm constraint)</span><span class="w">
</span><span class="n">mutations.smoothed</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mutations.smoothed</span><span class="p">[</span><span class="n">apply</span><span class="p">(</span><span class="n">mutations.smoothed</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">!</span><span class="nf">all</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="m">0</span><span class="p">)),]</span><span class="w">
</span></code></pre></div></div>

<h1 id="cancer-targeted-feature-selection">Cancer-targeted Feature Selection</h1>

<p>The necessity of selecting the most relevant mutations has already been acknowledged. As a plus, it can improve the specificity of the analysis if each cancer type was considered independently. It should be worth focusing on tumors highly represented in terms of cell lines: also a “poorly-represented” cancer type will be included to check whether the lower amount of data affects the performance of the model. First of all, let’s check the number of cell lines per tumor.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tissues_CCLE</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">mutations.smoothed</span><span class="p">)</span><span class="w">
</span><span class="n">tissues_CCLE</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">unique</span><span class="p">(</span><span class="n">gsub</span><span class="p">(</span><span class="s2">"[^_]*_(.*)"</span><span class="p">,</span><span class="w"> </span><span class="s2">"\\1"</span><span class="p">,</span><span class="w"> </span><span class="n">tissues_CCLE</span><span class="p">))</span><span class="w">

</span><span class="n">tissues_occurrencies</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">()</span><span class="w">
</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">tissues_CCLE</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="n">tmp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">grep</span><span class="p">(</span><span class="n">tissues_CCLE</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">mutations.smoothed</span><span class="p">))</span><span class="w">
   </span><span class="n">tissues_occurrencies</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="w">
   </span><span class="n">rm</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
  
</span><span class="n">tissues_occurrencies</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.data.frame</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="n">tissues_occurrencies</span><span class="p">))</span><span class="w">
</span><span class="n">colnames</span><span class="p">(</span><span class="n">tissues_occurrencies</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tissues_CCLE</span><span class="w">

</span><span class="c1"># Sort tissues_occurrencies data frame column-wise</span><span class="w">
</span><span class="n">sorted_tissues_occurrencies</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tissues_occurrencies</span><span class="p">[,</span><span class="w"> </span><span class="n">order</span><span class="p">(</span><span class="o">-</span><span class="n">apply</span><span class="p">(</span><span class="n">tissues_occurrencies</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">sum</span><span class="p">))]</span><span class="w">

</span><span class="c1"># Print the sorted data frame</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">sorted_tissues_occurrencies</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">])</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##   LUNG HAEMATOPOIETIC_AND_LYMPHOID_TISSUE CENTRAL_NERVOUS_SYSTEM SKIN LARGE_INTESTINE
## 1  185                                182                     68   61              59
</code></pre></div></div>

<p><em>Lung</em> and <em>Haematopoietic and Lymphoid Tissue</em> cancers will be included in the analysis; also <em>Breast</em> cancer will be considered, due to its
clinical relevance, despite offering just one third of the data with respect to the other two cancer types.</p>

<p>In the following lines of code, the most relevant mutations for these three tumors will be extracted, once again through NMF and exploiting
its built-in function featureScore(). The value <strong>s</strong> stands for the number of extracted mutations. <strong>k</strong> is the number of clusters.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">250</span><span class="w">
</span><span class="n">k</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">4</span><span class="w">

</span><span class="c1"># LUNG --------------------------------------------------------------------</span><span class="w">

</span><span class="c1"># Filtering out LUNG from data</span><span class="w">
</span><span class="n">mutations.smoothed_LUNG</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mutations.smoothed</span><span class="p">[,</span><span class="w"> </span><span class="n">grep</span><span class="p">(</span><span class="s2">"_LUNG"</span><span class="p">,</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">mutations.smoothed</span><span class="p">))]</span><span class="w">
</span><span class="n">mutations.smoothed_LUNG</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mutations.smoothed_LUNG</span><span class="p">[</span><span class="n">apply</span><span class="p">(</span><span class="n">mutations.smoothed_LUNG</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">!</span><span class="nf">all</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="m">0</span><span class="p">)),]</span><span class="w">

</span><span class="c1"># NMF</span><span class="w">
</span><span class="n">res_LUNG</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nmf</span><span class="p">(</span><span class="n">mutations.smoothed_LUNG</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="s1">'lee'</span><span class="p">,</span><span class="w"> </span><span class="n">seed</span><span class="o">=</span><span class="m">123456</span><span class="p">)</span><span class="w">
</span><span class="n">mutation_score_LUNG</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">featureScore</span><span class="p">(</span><span class="n">res_LUNG</span><span class="p">)</span><span class="w">

</span><span class="c1"># Feature selection</span><span class="w">
</span><span class="n">mutations_topscore_LUNG</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sort</span><span class="p">(</span><span class="n">featureScore</span><span class="p">(</span><span class="n">res_LUNG</span><span class="p">),</span><span class="w"> </span><span class="n">decreasing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="n">s</span><span class="p">]</span><span class="w">

</span><span class="c1"># Filter the mutations matrix based on scores</span><span class="w">
</span><span class="n">index</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">()</span><span class="w">
</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">mutations_topscore_LUNG</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="n">tmp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">grep</span><span class="p">(</span><span class="n">paste0</span><span class="p">(</span><span class="s2">"^"</span><span class="p">,</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">mutations_topscore_LUNG</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="s2">"$"</span><span class="p">),</span><span class="w"> </span><span class="n">row.names</span><span class="p">(</span><span class="n">mutations</span><span class="p">))</span><span class="w">
   </span><span class="k">if</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">&gt;</span><span class="m">1</span><span class="p">)</span><span class="w">
	</span><span class="n">cat</span><span class="p">(</span><span class="n">paste0</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span><span class="w"> </span><span class="s2">" "</span><span class="p">))</span><span class="w">
   </span><span class="n">index</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">tmp</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">mutations.filtered_LUNG</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mutations</span><span class="p">[</span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">grep</span><span class="p">(</span><span class="s2">"_LUNG"</span><span class="p">,</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">mutations</span><span class="p">))]</span><span class="w">

</span><span class="c1"># HLT ---------------------------------------------------------------------</span><span class="w">

</span><span class="c1"># Filtering out HLT from data</span><span class="w">
</span><span class="n">mutations.smoothed_HLT</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mutations.smoothed</span><span class="p">[,</span><span class="w"> </span><span class="n">grep</span><span class="p">(</span><span class="s2">"_HAEMATOPOIETIC_AND_LYMPHOID_TISSUE"</span><span class="p">,</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">mutations.smoothed</span><span class="p">))]</span><span class="w">
</span><span class="n">mutations.smoothed_HLT</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mutations.smoothed_HLT</span><span class="p">[</span><span class="n">apply</span><span class="p">(</span><span class="n">mutations.smoothed_HLT</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">!</span><span class="nf">all</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="m">0</span><span class="p">)),]</span><span class="w">

</span><span class="c1"># NMF</span><span class="w">
</span><span class="n">res_HLT</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nmf</span><span class="p">(</span><span class="n">mutations.smoothed_HLT</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="s1">'lee'</span><span class="p">,</span><span class="w"> </span><span class="n">seed</span><span class="o">=</span><span class="m">123456</span><span class="p">)</span><span class="w">
</span><span class="n">mutation_score_HLT</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">featureScore</span><span class="p">(</span><span class="n">res_HLT</span><span class="p">)</span><span class="w">

</span><span class="c1"># Feature selection</span><span class="w">
</span><span class="n">mutations_topscore_HLT</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sort</span><span class="p">(</span><span class="n">featureScore</span><span class="p">(</span><span class="n">res_HLT</span><span class="p">),</span><span class="w"> </span><span class="n">decreasing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="n">s</span><span class="p">]</span><span class="w">

</span><span class="c1"># Filter the mutations matrix based on scores</span><span class="w">
</span><span class="n">index</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">()</span><span class="w">
</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">mutations_topscore_HLT</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="n">tmp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">grep</span><span class="p">(</span><span class="n">paste0</span><span class="p">(</span><span class="s2">"^"</span><span class="p">,</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">mutations_topscore_HLT</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="s2">"$"</span><span class="p">),</span><span class="w"> </span><span class="n">row.names</span><span class="p">(</span><span class="n">mutations</span><span class="p">))</span><span class="w">
   </span><span class="k">if</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">&gt;</span><span class="m">1</span><span class="p">)</span><span class="w">
	</span><span class="n">cat</span><span class="p">(</span><span class="n">paste0</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span><span class="w"> </span><span class="s2">" "</span><span class="p">))</span><span class="w">
   </span><span class="n">index</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">tmp</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">mutations.filtered_HLT</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mutations</span><span class="p">[</span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">grep</span><span class="p">(</span><span class="s2">"_HAEMATOPOIETIC_AND_LYMPHOID_TISSUE"</span><span class="p">,</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">mutations</span><span class="p">))]</span><span class="w">

</span><span class="c1"># BREAST ---------------------------------------------------------------------</span><span class="w">

</span><span class="c1"># Filtering out BREAST from data</span><span class="w">
</span><span class="n">mutations.smoothed_BREAST</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mutations.smoothed</span><span class="p">[,</span><span class="w"> </span><span class="n">grep</span><span class="p">(</span><span class="s2">"_BREAST"</span><span class="p">,</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">mutations.smoothed</span><span class="p">))]</span><span class="w">
</span><span class="n">mutations.smoothed_BREAST</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mutations.smoothed_BREAST</span><span class="p">[</span><span class="n">apply</span><span class="p">(</span><span class="n">mutations.smoothed_BREAST</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">!</span><span class="nf">all</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="m">0</span><span class="p">)),]</span><span class="w">

</span><span class="c1"># NMF</span><span class="w">
</span><span class="n">res_BREAST</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nmf</span><span class="p">(</span><span class="n">mutations.smoothed_BREAST</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="s1">'lee'</span><span class="p">,</span><span class="w"> </span><span class="n">seed</span><span class="o">=</span><span class="m">123456</span><span class="p">)</span><span class="w">
</span><span class="n">mutation_score_BREAST</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">featureScore</span><span class="p">(</span><span class="n">res_BREAST</span><span class="p">)</span><span class="w">

</span><span class="c1"># Feature selection</span><span class="w">
</span><span class="n">mutations_topscore_BREAST</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sort</span><span class="p">(</span><span class="n">featureScore</span><span class="p">(</span><span class="n">res_BREAST</span><span class="p">),</span><span class="w"> </span><span class="n">decreasing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="n">s</span><span class="p">]</span><span class="w">

</span><span class="c1"># Filter the mutations matrix based on scores</span><span class="w">
</span><span class="n">index</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">()</span><span class="w">
</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">mutations_topscore_BREAST</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="n">tmp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">grep</span><span class="p">(</span><span class="n">paste0</span><span class="p">(</span><span class="s2">"^"</span><span class="p">,</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">mutations_topscore_BREAST</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="s2">"$"</span><span class="p">),</span><span class="w"> </span><span class="n">row.names</span><span class="p">(</span><span class="n">mutations</span><span class="p">))</span><span class="w">
   </span><span class="k">if</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">&gt;</span><span class="m">1</span><span class="p">)</span><span class="w">
	</span><span class="n">cat</span><span class="p">(</span><span class="n">paste0</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span><span class="w"> </span><span class="s2">" "</span><span class="p">))</span><span class="w">
   </span><span class="n">index</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">tmp</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">mutations.filtered_BREAST</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mutations</span><span class="p">[</span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">grep</span><span class="p">(</span><span class="s2">"_BREAST"</span><span class="p">,</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">mutations</span><span class="p">))]</span><span class="w">
</span></code></pre></div></div>

<h1 id="final-data--model-information">Final Data &amp; Model Information</h1>

<p>Let’s inspect the data. Besides the target data, already shown in the first chapter, now three tumor-targeted matrices have been created with a reduced and relevant number of mutations.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mutations.filtered_BREAST</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">,</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##              HCC2157_BREAST HS739T_BREAST HCC38_BREAST DU4475_BREAST MDAMB175VII_BREAST
## PDCD6_AMP                 0             0            0             0                  0
## EXOC3_AMP                 0             0            0             0                  0
## C5orf55_AMP               0             0            0             0                  0
## PP7080_AMP                0             0            0             0                  0
## AHRR_AMP                  0             0            0             0                  0
## SLC9A3_AMP                0             0            0             0                  0
## PLEKHG4B_AMP              0             0            0             0                  0
## LRRC14B_AMP               0             0            0             0                  0
## MIR4456_AMP               0             0            0             0                  0
## TPPP_AMP                  0             0            0             0                  0
</code></pre></div></div>

<p>Now that the mutation matrix has been reduced in size by considering both the most relevant mutations and the single cancer, it is possible to train and test a model able to predict the effect of a drug on a patient based on the cancer type and his mutational landscape.</p>

<h2 id="lung-cancer-analysis">Lung Cancer Analysis</h2>

<p>First thing is assemble the matrix for the model to be built on. One fundamental step is to consider only common cell lines, present both in
the mutation and the target data.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mutL</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mutations.filtered_LUNG</span><span class="w">

</span><span class="c1"># Filtering out LUNG from data</span><span class="w">
</span><span class="n">targetL</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">target</span><span class="p">[,</span><span class="w"> </span><span class="n">grep</span><span class="p">(</span><span class="s2">"_LUNG"</span><span class="p">,</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">target</span><span class="p">))]</span><span class="w">

</span><span class="n">target.common</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">targetL</span><span class="p">[,</span><span class="w"> </span><span class="n">which</span><span class="p">(</span><span class="n">colnames</span><span class="p">(</span><span class="n">targetL</span><span class="p">)</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">mutL</span><span class="p">))]</span><span class="w">
</span><span class="n">mutations.common</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mutL</span><span class="p">[,</span><span class="w"> </span><span class="n">which</span><span class="p">(</span><span class="n">colnames</span><span class="p">(</span><span class="n">mutL</span><span class="p">)</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">targetL</span><span class="p">))]</span><span class="w">
</span><span class="n">target.common</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="n">target.common</span><span class="p">[,</span><span class="w"> </span><span class="n">order</span><span class="p">(</span><span class="n">colnames</span><span class="p">(</span><span class="n">target.common</span><span class="p">))])</span><span class="w">
</span><span class="n">mutations.common</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="n">mutations.common</span><span class="p">[,</span><span class="w"> </span><span class="n">order</span><span class="p">(</span><span class="n">colnames</span><span class="p">(</span><span class="n">mutations.common</span><span class="p">))])</span><span class="w">

</span><span class="n">drug_names</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rownames</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>The following step consists of creating a list of matrices, one for each single drug, having the <em>response variable y</em> to be predicted as the
drug effectiveness. The mutation landscape for each cell line plays the role of <em>predictors</em>. For example…</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Creating the matrices with the response y for the single drug</span><span class="w">
</span><span class="n">tm.list</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list</span><span class="p">()</span><span class="w">

</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">drug_names</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="n">tmp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cbind</span><span class="p">(</span><span class="n">target.common</span><span class="p">[,</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">mutations.common</span><span class="p">)</span><span class="w">
   </span><span class="n">colnames</span><span class="p">(</span><span class="n">tmp</span><span class="p">)[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"drug"</span><span class="w">
   </span><span class="n">tmp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tmp</span><span class="p">[</span><span class="o">-</span><span class="n">which</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">tmp</span><span class="p">[,</span><span class="m">1</span><span class="p">])),</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="c1"># remove cell lines with NaN on drug response</span><span class="w">
   </span><span class="n">tmp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tmp</span><span class="p">[</span><span class="o">-</span><span class="n">which</span><span class="p">(</span><span class="n">rowSums</span><span class="p">(</span><span class="n">tmp</span><span class="p">[,</span><span class="m">-1</span><span class="p">])</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="p">]</span><span class="w">
   </span><span class="n">tm.list</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.data.frame</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="w">
   </span><span class="n">rm</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="nf">names</span><span class="p">(</span><span class="n">tm.list</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">row.names</span><span class="p">(</span><span class="n">targetL</span><span class="p">)</span><span class="w">

</span><span class="n">tm.list</span><span class="p">[[</span><span class="m">1</span><span class="p">]][</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">,</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##                   drug ZNF197_DEL ZNF501_DEL TCAIM_DEL ZNF660_DEL
## ABC1_LUNG    0.6937080          0          0         0          0
## BEN_LUNG     0.9529593          1          1         1          1
## CALU3_LUNG   0.8237809          0          0         0          0
## CHAGOK1_LUNG 0.6811019          1          1         1          1
## COLO668_LUNG 0.8997014          0          0         0          0
## CORL105_LUNG 0.7064098          1          1         1          1
## CORL95_LUNG  0.9313234          0          0         0          0
## CPCN_LUNG    0.7310353          1          1         1          1
## DMS114_LUNG  0.6837069          0          0         0          0
## DMS273_LUNG  0.4735742          0          0         0          0
</code></pre></div></div>

<p>The data are prepared as usual subdividing each matrix into training and test set.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Set the formula</span><span class="w">
</span><span class="n">f</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.formula</span><span class="p">(</span><span class="s2">"drug ~ ."</span><span class="p">)</span><span class="w">

</span><span class="c1"># Prepare Training &amp; Test set</span><span class="w">
</span><span class="n">train_frac</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0.8</span><span class="w">
</span><span class="n">train_set</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list</span><span class="p">()</span><span class="w">
</span><span class="n">test_set</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list</span><span class="p">()</span><span class="w">
</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">drug_names</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tm.list</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="w">
   </span><span class="n">index</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">nrow</span><span class="p">(</span><span class="n">data</span><span class="p">),</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">train_frac</span><span class="o">*</span><span class="n">nrow</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span><span class="w">
   </span><span class="n">train_set</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">,]</span><span class="w">
   </span><span class="n">test_set</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="n">index</span><span class="p">,]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Two different model types are built and compared in terms of performance: a Generalized Linear Model and a Neural Network.</p>

<p>Let’s have a look at the GLM first. A simple cross-validation control is applied in order to obtain a model whose performance is realistic.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">MSE.glm_LUNG</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">()</span><span class="w">
</span><span class="n">glm.models_LUNG</span><span class="w"> </span><span class="o">&lt;-</span><span class="nf">list</span><span class="p">()</span><span class="w">
</span><span class="n">response.glm_LUNG</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list</span><span class="p">()</span><span class="w">
</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">drug_names</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="n">train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">train_set</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="w">
   </span><span class="n">test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">test_set</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="w">

   </span><span class="n">glm.fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">caret</span><span class="o">::</span><span class="n">train</span><span class="p">(</span><span class="n">form</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w">
                           </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">train</span><span class="p">,</span><span class="w">
                           </span><span class="n">trControl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trainControl</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"cv"</span><span class="p">,</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">),</span><span class="w">
                           </span><span class="n">method</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">"glm"</span><span class="p">,</span><span class="w">
                           </span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gaussian</span><span class="p">()</span><span class="w">
    </span><span class="p">)</span><span class="w">
    </span><span class="n">glm.models_LUNG</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm.fit</span><span class="w">
    </span><span class="n">pr.glm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">glm.fit</span><span class="p">,</span><span class="n">test</span><span class="p">)</span><span class="w">
    </span><span class="n">response.glm_LUNG</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">pr.glm</span><span class="w">
    </span><span class="n">MSE.glm_LUNG</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">((</span><span class="n">pr.glm</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">test</span><span class="o">$</span><span class="n">drug</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="o">/</span><span class="n">nrow</span><span class="p">(</span><span class="n">test</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="nf">names</span><span class="p">(</span><span class="n">MSE.glm_LUNG</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">drug_names</span><span class="w">
</span><span class="nf">names</span><span class="p">(</span><span class="n">response.glm_LUNG</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">drug_names</span><span class="w">
</span></code></pre></div></div>

<p>The NN instead underwent a refinement processe. The number of hidden layers has always been kept to three, but the number of nodes has been selected after various attempts. First a simple model was chosen with a 5-5-5 layout, giving decent results; the high number of predictors may have suggested the use of a more complex model, such a 15-15-15 layout: the prediction error increased consistently. The model proposed below uses a 15-10-5 cascade-like layout, averaging the best performance error over the whole bunch of drugs analyzed.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">MSE.nn_LUNG</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">()</span><span class="w">
</span><span class="n">nn.models_LUNG</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list</span><span class="p">()</span><span class="w">
</span><span class="n">response.nn_LUNG</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list</span><span class="p">()</span><span class="w">
</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">drug_names</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="n">train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">train_set</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="w">
   </span><span class="n">test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">test_set</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="w">

   </span><span class="n">nn.fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">caret</span><span class="o">::</span><span class="n">train</span><span class="p">(</span><span class="n">form</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w">
                          </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">train</span><span class="p">,</span><span class="w">
                          </span><span class="n">trControl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trainControl</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"none"</span><span class="p">),</span><span class="w">
                          </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"neuralnet"</span><span class="p">,</span><span class="w">
                          </span><span class="n">linear.output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                          </span><span class="n">tuneGrid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expand.grid</span><span class="p">(</span><span class="w">
                                        </span><span class="n">layer1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">,</span><span class="w">
                                        </span><span class="n">layer2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w">
                                        </span><span class="n">layer3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">),</span><span class="w">
                          </span><span class="n">metric</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"RMSE"</span><span class="w">
      </span><span class="p">)</span><span class="w">
    </span><span class="n">nn.models_LUNG</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nn.fit</span><span class="w">
    </span><span class="n">pr.nn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">nn.fit</span><span class="p">,</span><span class="w"> </span><span class="n">test</span><span class="p">)</span><span class="w">
    </span><span class="n">response.nn_LUNG</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">pr.nn</span><span class="w">
    </span><span class="n">MSE.nn_LUNG</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">((</span><span class="n">pr.nn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">test</span><span class="o">$</span><span class="n">drug</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="o">/</span><span class="n">nrow</span><span class="p">(</span><span class="n">test</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="nf">names</span><span class="p">(</span><span class="n">MSE.nn_LUNG</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">drug_names</span><span class="w">
</span><span class="nf">names</span><span class="p">(</span><span class="n">response.nn_LUNG</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">drug_names</span><span class="w">
</span></code></pre></div></div>

<p>Let’s compare the performance of these two different model approaches: the Neural Network seems to fit better the data, averaging a lower mean squared error.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">))</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">MSE.glm_LUNG</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"l"</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s2">"blue"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="s2">"GLM"</span><span class="p">,</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0.5</span><span class="p">),</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s2">"drugs"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s2">"error"</span><span class="p">)</span><span class="w">
</span><span class="n">abline</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="n">mean</span><span class="p">(</span><span class="n">MSE.glm_LUNG</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s2">"red"</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">MSE.nn_LUNG</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"l"</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s2">"blue"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="s2">"Neural Network"</span><span class="p">,</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0.5</span><span class="p">),</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s2">"drugs"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s2">"error"</span><span class="p">)</span><span class="w">
</span><span class="n">bline</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="n">mean</span><span class="p">(</span><span class="n">MSE.nn_LUNG</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s2">"red"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>And in a boxplot flavor…</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">))</span><span class="w">
</span><span class="n">boxplot</span><span class="p">(</span><span class="n">MSE.glm_LUNG</span><span class="p">)</span><span class="w">
</span><span class="n">boxplot</span><span class="p">(</span><span class="n">MSE.nn_LUNG</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h2 id="results">Results</h2>

<p>It is worth comparing the performance of the models applied to the three selected cancer types.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mean_errors</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sapply</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">MSE.glm_LUNG</span><span class="p">,</span><span class="w"> </span><span class="n">MSE.nn_LUNG</span><span class="p">,</span><span class="w"> </span><span class="n">MSE.glm_HLT</span><span class="p">,</span><span class="w"> </span><span class="n">MSE.nn_HLT</span><span class="p">,</span><span class="w"> </span><span class="n">MSE.glm_BREAST</span><span class="p">,</span><span class="w"> </span><span class="n">MSE.nn_BREAST</span><span class="p">),</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span><span class="w">

</span><span class="n">model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s2">"GLM"</span><span class="p">,</span><span class="w"> </span><span class="s2">"NN"</span><span class="p">),</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w">
</span><span class="n">tumor</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="s2">"LUNG"</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="s2">"HLT"</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="s2">"BREAST"</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">))</span><span class="w">
</span><span class="n">performance</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">tumor</span><span class="p">,</span><span class="w"> </span><span class="n">mean_errors</span><span class="p">)</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">performance</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">mean_errors</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="n">tumor</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
   </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="s2">"dodge"</span><span class="p">,</span><span class="w"> </span><span class="n">stat</span><span class="o">=</span><span class="s2">"identity"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>The model performance is consistent among different cancer types: the neural network approach offers the lowest error. Surprisingly, Breast cancer data give a better performance than HLT, even though the number of involved cell lines is significantly lower: hence, the model is robust and independent from the mass of data available. This is an important feature, especially in cancer research, since data may be partly missing and/or scarce.</p>

          </article>

        </div>

    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        © Copyright 2024 Antonio  Collesei. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>.
Last updated: July 01, 2024.
      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
  <script defer src="/assets/js/zoom.js"></script><!-- Load Common JS -->
  <script defer src="/assets/js/common.js"></script>
  <script defer src="/assets/js/copy_code.js" type="text/javascript"></script>

    
  <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script>
  <script async src="https://badge.dimensions.ai/badge.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-1L3ZT6QV2E"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ window.dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-1L3ZT6QV2E');
  </script>
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": navbarHeight });
    $("progress-container").css({ "padding-top": navbarHeight });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>

  </body>
</html>
